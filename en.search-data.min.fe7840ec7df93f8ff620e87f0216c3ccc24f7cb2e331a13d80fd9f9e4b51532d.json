[{"id":0,"href":"/docs/cloud-infrastructure/","title":"Cloud Infrastructure","section":"Docs","content":"Introduction #  Super dope content here!\n"},{"id":1,"href":"/docs/developer-ready-cloud/","title":"Developer Ready Cloud","section":"Docs","content":"Introduction #  Super dope content here!\n"},{"id":2,"href":"/docs/dr-migration/","title":"DR \u0026 Migration","section":"Docs","content":"Introduction #  Welcome! Here you can find suggestions on how to plan, set up and operate your DR and Migration services.\nVMware Cloud Director Availability #  VMware Cloud Director Availability is a Disaster-Recovery-as-a-Service solution. It is specially designed and available for participants in VMware Cloud Provider Program and allows them to protect and migrate vApps and VMs:\n From on-premises vCenter Server site to a VMware Cloud Director cloud From VMware Cloud Director cloud to an on-premises vCenter Server environment Between VMware Cloud Director managed clouds  Use Cases #  VMware Cloud Director Availability supports two different use cases – disaster recovery and migration of vApps/VMs. Both of them rely on replication of virtual machines. In both cases at least one of the sides is a VMware Cloud Director managed cloud and the other side could be another VMware Cloud Director cloud or vCenter on-premises site. VMware Cloud Director Availability cannot protect or migrate bare metal servers or VMs managed by non-VMware hypervisors.\nDisaster Recovery #  A tenant can purchase DRaaS provided by a public cloud and based on VMware Cloud Director Availability to protect their virtual machines running in their on-premises datacenter. The Cloud Provider assigns a portion of compute, storage, and network resources from their cloud and groups them in an Organization Virtual Data Center (OrgVDC) that belongs to the tenant. Also, the Cloud Provider can enable this OrgVDC (respectively, the tenant) to protect their on-premises virtual workloads to the cloud with specific parameters like minimum RPO, bandwidth control, direction of the protection, and more. It allows the tenant to failover their VMs in case of an outage in their on-premises data center.\nMigration #  When tenants plan to migrate workloads to the cloud, they may use the Migration workflow to simplify the process. When a “New Migration” is configured, VMware Cloud Director Availability starts replication of the vApp/VM from the source to the destination.\nAppliances #  There are three VMware Cloud Director Availability appliances required for the setup in the cloud and one on-premises appliance to be deployed at the tenant\u0026rsquo;s on-premises site.\nCloud Replication Management Appliance #  The Cloud Replication Management appliance is responsible for the communication with VMware Cloud Director. Based on this communication, it discovers resources (OrgVCD, storage policies, datastores, networks, etc.) managed by VMware Cloud Director and used by the tenants. This information is required for discovering vApps/VMs that can be replicated/migrated or suitable destination locations for incoming replications/migrations.\nIt also provides the VMware Cloud Director Availability UI and API interfaces. Another role of this appliance is to communicate with all the local and remote Replicators and receive data regarding each protected/migrated workload. Two VMware Cloud Director Availability services cover these functionalities in Cloud Replication Management appliance – the cloud.service and the manager.service.\nCloud Service #  This service understands the VMware Cloud Director constructs – OrgVCD, vApps, networks managed by VMware Cloud Director, storage policies, etc. To achieve this VMware Cloud Director Availability Cloud Management appliance communicates with the VMware Cloud Director API through the VMware Cloud Director LB. The Cloud Replication Management appliance does not communicate with the VMware Cloud Director consoleproxy cells/interfaces. Based on this, VMware Cloud Director Availability can:\n discover VMware Cloud Director managed vApps/VMs and protect/migrate them to another DR-enabled cloud or on-premises vCenter discover a suitable destination for incoming replications/migrations  The cloud service manages pairings with other DR-enabled clouds, policies, SLA profiles, and their assignment to VMware Cloud Director organizations. It provides information about the replication and system tasks. Also, it reports the replication compute resources consumption per tenant and per PVDC, the storage consumption per datastore, plus many other high- and low-level details. The cloud service management interface is available on https://vcda_manager_fqdn:443/admin. It is possible to log in with the local OS root account, an SSO account if the appliance has registration in an SSO domain, or with a VMware Cloud Director System Administrator account if the initial configuration is already completed.\nManager Service #  The manager service manages the registrations of local and remote replicators. During the pairing process, remote replicators are registered in the Cloud Replication Management appliance. For each replication, it chooses one replicator from the source site and one from the destination site. The destination replicator is responsible for discovering the appropriate resources to create the replica disks at the destination and write data. Replicators send information to the Cloud Replication Management appliance about their operation – statuses, amount of data replicated, operation start time, time to complete, etc. The manager service is also used to manage replicators. It can trigger the rebalancing of replications across all replicators or put a replicator in maintenance mode, which leads to assigning each of its replications to another one. This is useful when the current replicators need to be offloaded by adding a new replicator in the solution.\nThe manager service management interface is available at https://vcda_manager_fqdn:8441. It is possible to log in with the local OS root account and an SSO account if the appliance is already registered in Lookup Service.\nCloud Replicator #  Cloud Replicator is responsible for moving the replication data around - to and from the ESXi hosts and the cloud. For outgoing replications/migrations, it communicates with the VMKernel interface of the ESXi host, captures and encrypts replication data, optionally compresses it, and sends it to the remote replicator, which can be another Cloud Replicator or on-premises Replicator. For incoming replications/migrations the Cloud Replicator receives replication data from a Replicator (cloud or on-premises), decompresses and decrypts this data, and sends it to the ESXi to be written on a datastore. Cloud Replicator is the only component that can scale out as the number of protections/migrations increases.\nCloud Tunnel #  The Cloud Tunnel appliance is the single-entry point to the VMware Cloud Director Availability instance in the cloud. Its role is to handle and forward the incoming management and replication traffic. It is the only VMware Cloud Director Availability appliance that needs a dedicated Internet-accessible endpoint.\nOn-premises Appliance #  The VMware Cloud Director Availability on-premises appliance is deployed in the tenant data center. It creates a pairing relation to VMware Cloud Director Availability in the cloud and can protect and/or migrate VMs running locally. The on-premises appliance does not require a public endpoint as it only initiates connectivity to the cloud. A single on-premises appliance can protect VMs from a single SSO domain even if there are multiple vCenter Servers in this SSO domain. If the requirement is to do replications from the cloud to on-premises, then a single appliance is required for each vCenter due to how placement works. Also, one on-premises appliance can be paired to a single VMware Cloud Director Availability instance in the cloud. If the tenant intends to use more than one DR service in the cloud, a dedicated appliance is required for each cloud DR service.\nReference #  Official documentation\n"},{"id":3,"href":"/docs/networking-security/","title":"Networking \u0026 Security","section":"Docs","content":"Introduction #  Super dope content here!\n"},{"id":4,"href":"/docs/cloud-infrastructure/planning/","title":"Planning and Preparation","section":"Cloud Infrastructure","content":"Planning and Preparation #  Your content comes here!\n"},{"id":5,"href":"/docs/developer-ready-cloud/planning/","title":"Planning and Preparation","section":"Developer Ready Cloud","content":"Planning and Preparation #  Your content comes here!\n"},{"id":6,"href":"/docs/dr-migration/planning/","title":"Planning and Preparation","section":"DR \u0026 Migration","content":"Planning and Preparation #  Everything you need to know before deploying VMware Cloud Director Availability.\nHardware Requirements #     Appliance Type Description and Services Hardware Requirements     Cloud Replication Management Appliance A dedicated appliance, that runs the following VMware Cloud Director Availability services: * Manager Service * Cloud Service with embedded VMware Cloud Director Availability Tenant Portal - 2 vCPUs - 4 GB RAM\n- 10 GB Storage   Cloud Replicator Appliance A dedicated appliance for the Replicator Service that handles the replication traffic for a site. For large-scale environments, you can deploy more than one Cloud Replicator Appliance per cloud site. - 4 vCPUs - 6 GB RAM - 10 GB Storage   Cloud Tunnel Appliance A dedicated appliance for the Tunnel Service. - 2 vCPUs - 2 GB RAM\n- 10 GB Storage    Other Requirements #  The resource vCenter Server instances within a VMware Cloud Director site must be within the same single sign-on domain. All Replicator Service, Manager Service, Cloud Service, and Tunnel Service instances within the respective site must be configured with that same single sign-on domain.\nNetwork Ports #     Source Destination Port Number Protocol Description     VMware Cloud Director Availability Replicator ESXi Hosts 902 TCP and UDP Used by the VMware Cloud Director Availability Replicator service for replication traffic to the destination ESXi hosts.   VMware Cloud Director Availability Replicator VMware Platform Services Controller® 443 TCP Used for single sign-on and Lookup Service communication.   VMware Cloud Director Availability Replicator vCenter Server 443 TCP Used by the local VMware Cloud Director Availability vApp Replication Manager service or the VMware Cloud Director Availability Replicator service for communication with the local vCenter Server.   VMware Cloud Director Availability Replicator VMware Cloud Director Availability vApp Replication Manager 8044 TCP Used for vCloud Availability vApp Replication Manager management from the vCloud Availability Replicator.   VMware Cloud Director Availability Replicator VMware Cloud Director Availability Tunnel 8048 TCP Used for VMware Cloud Director Availability vApp Replication Manager management from the VMware Cloud Director Availability Replicator.   VMware Cloud Director Availability vApp Replication Manager VMware Platform Services Controller® 443 TCP Used for single sign-on and Lookup Service communication.   VMware Cloud Director Availability vApp Replication Manager VMware Cloud Director service 443 TCP Used for VMware Cloud Director Director management from the VMware Cloud Director Availability vApp Replication Manager.    VMware Cloud Director Availability vApp Replication Manager VMware Cloud Director Availability Replicator 8043 TCP Used for VMware Cloud Director Availability Replicator management from the VMware Cloud Director Availability vApp Replication Manager.    VMware Cloud Director Availability vApp Replication Manager VMware Cloud Director Availability Tunnel 8047, 8048 TCP Used for VMware Cloud Director Availability Tunnel management from the VMware Cloud Director Availability vApp Replication Manager.    VMware Cloud Director Availability Tunnel VMware Cloud Director Availability Replicator 8043, 44045 TCP Used for VMware Cloud Director Availability Replicator management from the VMware Cloud Director Availability Tunnel.    VMware Cloud Director Availability Tunnel VMware Cloud Director Availability vApp Replication Manager 8044, 8046 TCP Used for VMware Cloud Director Availability vApp Replication Manager service management from the VMware Cloud Director Availability Tunnel appliance.    VMware Cloud Director Availability Tunnel VMware Platform Services Controller® 443 TCP Used for VMware Platform Services Controller® communication management from the VMware Cloud Director Availability vApp Replication Manager and VMware Cloud Director Availability Replicator.    ESXi Hosts VMware Cloud Director Availability Replicator 31031, 44045, 44046 TCP Used by the ESXi hosts for replication traffic to the destination VMware Cloud Director Availability Replicator service.    Firewall VMware Cloud Director Availability Tunnel 8048 TCP Used for redirecting external traffic management to the VMware Cloud Director Availability Tunnel service.     Important Considerations #  Replication Traffic #  A typical good practice is to separate the management and resource vCenters/clusters. The number of hosts in resource vCenters/clusters is significantly higher than the number in the management cluster. A recommendation is to deploy Replicators on resource hosts and not in the management cluster so more Replicators can be deployed and a DRS rule can be created to keep the Replicator VMs on different hosts for better load distribution. Also, the replication traffic path from the Replicator appliances to the replication network on the resource hosts will be enhanced. The hosts can use the management vmkernel interface to communicate with the Replicator. Another option is to have a dedicated vmkernel interface for replication purposes only. Using the management vmkernel simplifies the configuration but significantly reduces the control options available to the administrator and can lead to a risk for routing uncompressed replication traffic, which is highly non-desired. The general recommendation is to use a dedicated vmkernel for the replication traffic. In this case, the administrator will have better control over the infrastructure. Using NIOC, the administrator will be able to set shares for different types of vmkernel traffic. It enables carrying the replication traffic over dedicated uplinks.\nNote: If any other VMware HBR-based replication products (vSphere Replication, VMware Site Recovery Manager or VMware HCX) are used in this cloud, configuring a dedicated vmkernel interface marked with “vSphere Replication” and “vSphere NFC Replication” will lead to all of these products try to use it. This means the network connectivity between their appliances and the replication vmkernel interfaces will be required to enable all of these products to operate successfully. For more information, please consult with respective product documentation.\nStorage Requirements #  For a successful test failover, the destination storage must accommodate double the source virtual machine disk size. VMware Cloud Director Availability 4.2 and later do not consume double the disk size during failover.\n Example required space in the datastore, for a source virtual machine with a 2 TB virtual disk. When the replication is created, VMware Cloud Director Availability allocates 2 TB in the destination storage. VMware Cloud Director Availability allocates additional 2 TB when starting a test failover task. After finishing the test failover task, the additional 2 TB space is unallocated. Example for a VMware vSAN storage, with the same virtual machine. The same storage implication applies, where the vSAN must accommodate double the virtual machine disk size. When the replication is created in this example, VMware Cloud Director Availability allocates 2 TB multiplied by the vSAN_Protection_Level_Disk_Space_Penalty. When starting a test failover task, additional 2 TB are allocated multiplied by the vSAN_Protection_Level_Disk_Space_Penalty.  "},{"id":7,"href":"/docs/networking-security/planning/","title":"Planning and Preparation","section":"Networking \u0026 Security","content":"Planning and Preparation #  Your content comes here!\n"},{"id":8,"href":"/docs/sovereign-cloud/planning/","title":"Planning and Preparation","section":"Sovereign Cloud","content":"Planning and Preparation #  Your content comes here!\n"},{"id":9,"href":"/docs/sovereign-cloud/","title":"Sovereign Cloud","section":"Docs","content":"Introduction #  Super dope content here!\n"},{"id":10,"href":"/docs/cloud-infrastructure/design/","title":"Design","section":"Cloud Infrastructure","content":"Design #  Your content comes here!\n"},{"id":11,"href":"/docs/developer-ready-cloud/design/","title":"Design","section":"Developer Ready Cloud","content":"Design #  Your content comes here!\n"},{"id":12,"href":"/docs/dr-migration/design/","title":"Design","section":"DR \u0026 Migration","content":"Design #  Architecture #  The following diagram shows the network flow between the VMware Cloud Director Availability components and the other infrastructure components part of the replication process.\nOther Components #  Platform Services Controller #  All the VMware Cloud Director Availability appliances need to be configured with a Lookup Service for two purposes:\n Service authentication and resource discovery – the Replicator and Management appliances require registration with a Lookup Service to authenticate to the resource vCenters and discover resources which is required for operations from the VMware Cloud Director Availability workflow. Authentication to the VMware Cloud Director Availability service by the administrator which is not mandatory. The Lookup Service has to be the one used by vCenters providing compute resources to VMware Cloud Director. For cases when the management and resource vCenters use different Lookup Services and the VMware Cloud Director Availability appliances are deployed at the management vCenter, they need to be configured with the Lookup Service of the resource vCenter(s) from/to which they will protect VMs/vApps.  The Lookup Service and the associated Single Sign-On (SSO) domain is the boundary of a single VMware Cloud Director Availability instance. This is because a single Cloud Replication Management appliance can be registered with a single Lookup Service providing DR and migration services only for workloads in this SSO domain. For cases when the cloud provider has multiple PVDCs in more than one SSO domain, a VMware Cloud Director Availability instance (tunnel, manager, replicators) needs to be deployed per each SSO domain. It is possible to deploy a dedicated VMware Cloud Director Availability instance per PVDC, but one can protect as many PVDCs as exist in a single SSO domain.\nvCenter Server #  VMware Cloud Director Availability needs to discover the workload VMs that need to be protected or migrated and destination resources (clusters, datastores, networks, etc.) for incoming replications and/or migrations in vCenters that are configured to provide the resources for VMware Cloud Director.\nThe Replicator is the component that communicates with the vCenter Servers. The tunnel has no such requirement.\nVMware Cloud Director #  The integration with VMware Cloud Director is done through the Cloud Replication Management appliance. The Cloud service communicates with VMware Cloud Director to discover the vApps/VMs for outgoing replications/migrations or destination resources (OrgVDC, network, storage) for incoming replications/migrations. VMware Cloud Director Availability uses the VMware Cloud Director API to request the information and initiate any operations.\nAs part of the initial setup, the administrator provides the VMware Cloud Director API HTTPS Base URL followed by /api and user account, which is a member of the System organization with its password. Then VMware Cloud Director Availability inspects the certificate presented by VMware Cloud Director. If the FQDN of the API HTTPS Base URL is not set as the Subject Alternative Name DNS entry, the registration cannot be completed. It is not enough to have this FQDN present in the certificate Common Name field. When a TLS connection to VMware Cloud Director is established and the authentication with the provided credentials is successful, VMware Cloud Director Availability uses the VMware Cloud Director REST API to discover its UI endpoint. Depending on its value, the VMware Cloud Director Availability HTTP server is dynamically reconfigured - the respective domain is added to the CORS allowlist.\nAdditional Information: CORS is an HTTP mechanism that provides better security to end-users. Depending on how the server is configured, browsers may reject attempts to load resources from a server that is on domain A, but someone tries to load it in domain B. The VMware Cloud Director Availability Cloud service is set to allow only one VMware Cloud Director endpoint - the VMware Cloud Director UI endpoint or, if it is not configured, the API endpoint. Once the certificate and credentials check are successful, VMware Cloud Director Availability deploys the files required for extension operation in the VMware Cloud Director cells.\nESXi hosts #  The Replicators communicate with hosts to:\n Configure the source VM for replication by enabling IO filter and configure it where to send replication data Allocate resources in the host for the destination replication  These operations are performed by the HBRsrv service. For authentication purposes, it needs to communicate to the hosts on port 80/tcp. For the data traffic, it uses 902/tcp to hosts to send the replication data (for incoming replications) and 44046/tcp from the hosts to receive replication data (for outgoing replications).\nData Paths #  Two appliances are responsible for the replication data path – the Replicator and the Tunnel. The Cloud Replication Management appliance does not handle any replication data.\nCloud Tunnel #  The Tunnel is a transparent proxy that is aware of the TLS protocol. It receives the incoming traffic and redirects it to the backend components based on its type. The management and HTTPS/API traffic is sent to the Cloud Replication Management, and the replication data traffic is sent to Replicator. It does not perform any operations on the replication traffic. The Tunnel appliance does not consume significant compute resources, but in environments with many replications may handle a significant amount of network traffic. As it is published to the Internet via DNAT, it is recommended to connect it to a DMZ network where all the necessary security measures for such publish rules are taken.\nCloud Replicator #  The Replicator appliance runs three services – HBRsrv, LWDproxy, and Replicator.\nThe HBRsrv is a low-level component that communicates with the replication IO filter in ESXi hosts. The protocol used for communication is called LWD (Light Weight Delta) - a VMware proprietary protocol. This service is not aware of vCenter and does not communicate with it. The HBRsrv service is responsible for saving the VM deltas generated during the RPO window on the destination datastore. It is a common service for other VMware replication products, and VMware Cloud Director Availability reuses it for moving replication data at the last mile. It configures the ESXi filter to send the replication traffic between the ESXi host and source Replicator in \u0026ldquo;plain text\u0026rdquo;. When the data is received by the source LWDproxy, it gets encrypted and optionally compressed. On the destination site, there\u0026rsquo;s another LWDproxy that decrypts and decompresses the LWD traffic, and the destination Replicator sends the replication data to an ESXi host.\nThe LWDproxy is a VMware Cloud Director Availability service that ensures that replication traffic is sent to the Tunnel and is encrypted and compressed outside the local infrastructure. The LWDProxy service communicates with the Tunnel for sending/receiving replication data. Encryption and compression result in increased CPU utilization for the Replicator appliance. This may reduce the number of replications a single Replicator can handle.\nThe Replicator service is a VMware Cloud Director Availability management service that sends configuration instructions to the HBRsrv and LWDproxy services for every replication handled by the Replicator appliance. It understands the vCenter objects like hosts, VMs, datastores, etc. In this way, the Replicator discovers and prepares the source VMs for replication and creates objects (independent disks) for the incoming replications. It is supposed there will be hundreds or thousands of VM replications/migrations in a cloud environment. Even if the number of replications is lower than the maximum supported handled by a single Replicator, it is highly recommended to deploy at least two or more replicators. With several Replicators, the load generated by the replications can be spread over multiple hosts. Balance the replication traffic on more physical uplinks and distribute the load better. A single Replicator can be put in maintenance mode during a maintenance window without affecting replication traffic.\n"},{"id":13,"href":"/docs/networking-security/design/","title":"Design","section":"Networking \u0026 Security","content":"Design #  Your content comes here!\nRelative\nAbsolute\n"},{"id":14,"href":"/docs/sovereign-cloud/design/","title":"Design","section":"Sovereign Cloud","content":"Design #  Your content comes here!\n"},{"id":15,"href":"/docs/cloud-infrastructure/implementation/","title":"Implementation","section":"Cloud Infrastructure","content":"Implementation #  Welcome!\nConfiguring Cloud Director service for VMware Cloud on AWS #  See the instructions below on how to deploy VMware Cloud on AWS (VMConAWS) for multi-tenancy with VMware Cloud Director service.\nVMware Cloud Director Service for VMware Cloud on AWS Deployment Guide\n"},{"id":16,"href":"/docs/developer-ready-cloud/implementation/","title":"Implementation","section":"Developer Ready Cloud","content":"Implementation #  You content comes here!\n"},{"id":17,"href":"/docs/dr-migration/implementation/","title":"Implementation","section":"DR \u0026 Migration","content":"Implementation #  Welcome!\n"},{"id":18,"href":"/docs/networking-security/implementation/","title":"Implementation","section":"Networking \u0026 Security","content":"Implementation #  You content comes here!\n"},{"id":19,"href":"/docs/sovereign-cloud/implementation/","title":"Implementation","section":"Sovereign Cloud","content":"Implementation #  You content comes here!\n"},{"id":20,"href":"/docs/cloud-infrastructure/operations/","title":"Operations","section":"Cloud Infrastructure","content":"Operations #  vCenter Server Metering #  Usage Meter collects product usage information from all vCenter servers that are registered with Usage Meter.\nNote: Usage Meter does not traverse Enhanced Linked Mode, and it requires registering all vCenter servers, part of this mode, to meter their usage data.\nVMware Cloud Provider Program partners should utilize VCPP licenses for all servers used in the service delivery path or administration control plane. VMware perpetual licenses, including OEM versions, can only be utilized to support internal IT operations that are not part of service delivery. In addition, VMware perpetual licenses may not be used to support the management or operations of an environment utilized to host unaffiliated third parties. Virtual machines running on hosts with perpetual or demo license keys are metered by Usage Meter.\nConfiguration #  The Usage Meter administrator must configure the endpoint and credentials for each vCenter server to be metered using the Usage Meter web application.\nFeature Detection #  When metering vCenter, Usage Meter performs two types of usage collections: event-based and inventory collections.\nEvent history collections #  Usage meter subscribes to vCenter events to detect changes in a virtual machine and host state. Changes in a virtual machine state are delivered every hour to Usage Meter and recorded.\nNote: Usage Meter collects data from hosts and VMs in an active state. Even when there is a connectivity issue with a host, Usage Meter will still report metering data if the host VMs are in a powered-on state. This means that providers will be billed for VMs even when there are temporary interruptions in host connectivity. If providers want to be sure they are not being billed for VMs, they need to turn those VMs off.\nInventory collections #  Usage Meter queries vCenter servers every eight hours to collect full inventory information.\nvCenter Reporting #  The vCenter Server Standard edition is part of the Flex Core bundle and therefore reported as part of that bundle. vCenter usage is bundled by default and cannot be reported standalone.\n"},{"id":21,"href":"/docs/developer-ready-cloud/operations/","title":"Operations","section":"Developer Ready Cloud","content":"Operations #  API Tokens in Cloud Director #  VMware Cloud Director 10.3.1 introduced API Tokens. This allows a user to generate API tokens for programmatic access to VCD. It works for both, provider, and tenant users. An automation script or 3rd-party solution can then use the API token to make API requests to Cloud Director on behalf of the user.\nThese steps are used to create API tokens:\n The provider propagates the right to use and manage API token to the tenant The Cloud Director user (provider as well as tenant user) creates an API token An API client (e.g. an automation script) uses the API token to make requests (If needed) The user revokes the API token  Preparation #  As for most new features, fine-grained access control through rights bundles is possible. To enable a tenant to use API token, the provider must publish a rights bundle to the tenant. Privileges can be defined for a user to manage the user’s own tokens, and to manage all Organization user’s token (for example for an Organization Administrator).\nCreate the API Token #  As provider or tenant user with proper privileges you can use the “User Preferences” menu to create the API token. Each token can be labeled with a name. Be aware that the actual token key is only visible once in the creation wizard and cannot be retrieved afterwards.\nRevoke the API Token #  API tokens do not expire, but existing API tokens can be revoked. This also invalidates active API client sessions that used the token to authenticate. All users can revoke their own tokens. Administrators (those with \u0026lsquo;manage all user\u0026rsquo;s API tokens\u0026rsquo; right) can revoke other user\u0026rsquo;s tokens. Tenant administrators can do so within their own Organization, while system administrators can do so for any user.\nUse the API Token #  Semantically the API token usage follows the OAuth 2.0 specification (RFC 6749, section 6).\nThe API token can then be used by a 3rd-party solution or custom API client to access the VCD API as the user, without the need to authenticate with username and password credentials.\nAPI Client Example #  Request the bearer token for subsequent calls using the API token:\nPOST https://host_name/oauth/provider/token Accept: application/json Content-Type: application/x-www-form-urlencoded Body: grant\\_type=refresh\\_token\u0026amp;refresh\\_token=Generated\\_API_Token  Security note: It’s recommended to send the API Token as part of the request body (and not as part of the URL, even if that technically works for x-www-form-urlencoded type requests), to avoid it being logged in transit.\nResponse containing the Bearer token:\nHTTP/1.1 200 OK Content-Type: application/json Body: { \u0026quot;access\\_token\u0026quot;:\u0026quot;Generated\\_Access_Token\u0026quot;, \u0026quot;token_type\u0026quot;:\u0026quot;Bearer\u0026quot;, \u0026quot;expires_in\u0026quot;:86400, \u0026quot;refresh_token\u0026quot;:null }  Subsequent API call now can use the returned Bearer token in the \u0026ldquo;access_token\u0026rdquo; field as usual. There is no need for any changes in the client code.\nSubsequent Call using the Bearer token:\nGET https://host_name/api/org Accept: application/*+xml;version=36.1 Authorization: Bearer Generated\\_Access\\_Token  Notes #  The session expiration can be configured in the provider portal under General \u0026gt; Timeouts.\nThe VCD Provider for Terraform for example supports API Token authentication as of version 3.5:\nprovider \u0026quot;vcd\u0026quot; { user = \u0026quot;none\u0026quot; password = \u0026quot;none\u0026quot; auth\\_type = \u0026quot;api\\_token\u0026quot; api_token = Generated API token sysorg = \u0026quot;System\u0026quot; ...  For security reasons, certain tasks are not possible when authenticated through an API token:\n Change the user password Perform user management tasks Create more tokens View or revoke other tokens  When accessing VMware Cloud Director by using an API access token, applications have only view rights for the following resources.\n User Group Roles Global roles Rights bundles  The API Token feature in VMware Cloud Director offers a secure way for automation solutions to access its API, even in environments that enforce Multi-factor Authentication for user logins.\nReference links: #  VCD Tenant Portal Documentation: https://docs.vmware.com/en/VMware-Cloud-Director/10.3/VMware-Cloud-Director-Tenant-Portal-Guide/GUID-A1B3B2FA-7B2C-4EE1-9D1B-188BE703EEDE.html\nVCD Provider Portal Documentation: https://docs.vmware.com/en/VMware-Cloud-Director/10.3/VMware-Cloud-Director-Service-Provider-Admin-Portal-Guide/GUID-A1B3B2FA-7B2C-4EE1-9D1B-188BE703EEDE.html\nOAuth 2.0 Specification (RFC 6749): https://datatracker.ietf.org/doc/html/rfc6749#section-6\nVCD Provider for Terraform 3.5.1 Documentation: https://registry.terraform.io/providers/vmware/vcd/latest/docs\n"},{"id":22,"href":"/docs/dr-migration/operations/","title":"Operations","section":"DR \u0026 Migration","content":"Operations #  Concent comes here \\o/\n"},{"id":23,"href":"/docs/networking-security/operations/","title":"Operations","section":"Networking \u0026 Security","content":"Operations #  Your content comes here!\n"},{"id":24,"href":"/docs/sovereign-cloud/operations/","title":"Operations","section":"Sovereign Cloud","content":"Operations #  Your content comes here!\n"},{"id":25,"href":"/docs/cloud-infrastructure/cds-vmc-deployment-guide-msp/","title":"VMware Cloud Director Service for VMware Cloud on AWS Deployment Guide","section":"Cloud Infrastructure","content":"VMware Cloud Director Service for VMware Cloud on AWS Deployment Guide #  VMware Cloud Director™ service enables cloud providers to use VMware Cloud on AWS in multi-tenant modality with enhanced VMware NSX-T support, allowing provisioning of custom-sized, tenant-based, isolated, and secure VMware Cloud resources. This ability to service multiple smaller and medium sized tenants on the same infrastructure, offers flexibility to right-size the VMware Cloud on AWS environments to meet customer needs and requirements of all customer tiers.\nVMware Cloud Director service is a container-based SaaS version of the proven VMware Cloud Director on-premises service-delivery platform. The service, available through VMware Cloud Partner Navigator, helps cloud providers gain better economies of scale and generate new value and revenue for their cloud businesses.\nThis guide details the process of deploying a VMware Cloud Director service Instance, associating it with a VMware Cloud on AWS SDDC designed for use with VMware Cloud Director service, configuring the Provider Virtual Datacenter to use the resources of the associated VMware Cloud on AWS SDDC, configuring the VMware Cloud on AWS SDDC networking to prepare it for multi-tenant use and deploying the first tenant organization.\nBefore using this guide, it is necessary to join the VMware Managed Service Provider Program and have the require contracts in place to use the VMware Cloud services mentioned in this guide. See the MSP VMware Cloud on AWS Operations Handbook and the Cloud Director service Operations Handbook for more details.\nPrepare a VMware Cloud Partner Navigator Provider Organization #  Provision a new VMware Cloud Partner Navigator Organization\n  Click on Administration, then Add Organization\n  Fill out the Add Organization form and click Add Organization\nRequest access to VMware Cloud Director service by emailing: ask_cloud_director_service@VMware.com\n  Supply the Long ID of the Organization that will be used.\n  A onetime use invitation will be returned to activate VMware Cloud Director service.\nEnable the VMware Cloud on AWS and VMware Cloud Director service services in the new Organization\n  Select the new Provider Organization and click Manage Services\n  Click Continue\n  Click Open on both service tiles to activate the services   Click Open to continue\n  NOTE: It is also acceptable to use an existing Provider Organization enabled for VMware Cloud on AWS [which has no SDDCs currently deployed.]{.underline}\nDeploy a SDDC #  Deploy the SDDC in the same VMware Cloud Partner Navigator Organization activated above.\n  Select the VMware Cloud on AWS service tile   Select SDDCs and click Create SDDC\n  Fill out the form to deploy the SDDC according to your requirements. For more details about the deployment process for VMware Cloud on AWS SDDCs see Deploy an SDDC from the VMC Console.\n  NOTE: All VMware Cloud on AWS SDDCs used with VMware Cloud Director service must be deployed in Organizations that have been enabled for VMware Cloud Director service. SDDCs deployed in other Organizations are not compatible with VMware Cloud Director service.\nDeploy VMware Cloud Director service Instance #    Select the VMware Cloud Director service tile  If someone other than the Organization Owner will be deploying VMware Cloud Director service Instances the Organization Owner must first establish a trust relationship between VMware Cloud services and VMware Cloud Director service.\na. In the Cloud Director Instances screen select Configuration then Configure OAuth Trust Relationshipb. Select Dismiss once the trust is established\n![Graphical user interface, text, application Description automatically generated](/static/images/cloud-infrastructure-cds-vmc/cloud-infrastructure-cds-vmc12.png)    Select Create Instance to begin the instance deployment process.   Enter the data needed in the form and click on NEXT\n  Note: For the Upgrade Category, selecting Preview (if enabled) identifies this Cloud Director service Instance to be patched or upgraded earlier than when Production is selected. Use Preview for service development environments. The Upgrade Category cannot be changed after deployment.\n Acknowledge costs and then click on CREATE INSTANCE\n  Click on Activity Log for detailed information about the deployment progress.\n  When theÂ VMware Cloud DirectorÂ instance deployment is complete, its card displays aÂ ReadyÂ status.\nGenerate API Token #  An API token for the Organization holding the SDDC is used to associate the SDDC with VMware Cloud Director service.\n  Click on your name in the top right and then click on My Account\n  Click on API Tokens\n  Click on GENERATE TOKEN\n  Enter form fields and then click on GENERATE\n  Notes: This token is only used during the association process, so its Token TTL should be short. Minimum required Organization Role is Organization Member. Minimum required Service Roles are VMware Cloud on AWS - Administrator and VMware Cloud on AWS - NSX Cloud Admin. Make sure to store the generated token in a safe place.\nCreate a DHCP Network #  Need to create a network segment that has routed access to the SDDC management network, provides DHCP service and has a DNS server configured. Note: This step can be skipped if you only have one host in your SDDC.\n  Click on ADD SEGMENT\n  Enter segment details and then click on SET DHCP CONFIG\n  Enter details and then click on APPLY\n  Click SAVE\n  S3 Configuration #  If your SDDC is in Oregon (us-west-2), you will need to either disable S3 or configure a S3 VPC endpoint prior to associating the SDDC. If your SDDC is in any other region, this step can be skipped. By default, S3 traffic in the local region fails until either a VPC endpoint is configured or S3 is disabled. Part of the associate process automatically deploys a proxy appliance into the SDDC. That proxy appliance currently is stored on an S3 bucket in Oregon (us-west-2), which given the default configuration makes it inaccessible.\nDisable S3 #   Click DISABLE\n  Configure S3 VPC endpoint #  See the Amazon Virtual Private Cloud AWS PrivateLink documentation: Endpoints for Amazon S3\nAssociate VMware Cloud Director service Instance #    Click Associate a VMC SDDC\n  Enter fields and then click on ASSOCIATE a VMC SDDC\n  Note: If you only have one host in your SDDC, you can use the predefined network named \u0026ldquo;sddc-cgw-network-1\u0026rdquo; for the Proxy VM Network field.\nAssociate Custom Domain (Optional) #  Allows the provider to use their own domain name for VMware Cloud Director service Instances.\n  Click on ACTIONS and then click on Associate Custom Domain\nSee the VMware Cloud Director service documentation Customize the DNS and Certificate Settings for more details.\n  VMware Cloud Director service Instance Configuration #  Launch the Provider Portal #    To use VMware Cloud Services as an Identity Provider for VMware Cloud Director service Instances, select Configure VMware Cloud Services as instance IDP from the Actions menu of each VMware Cloud Director service Instance.   Select Configure IDP\n  Click on OPEN INSTANCE\n  NOTE: To control user access when VMware Cloud Services is used as the VMware Cloud Director service Instance IDP, use the Role Assignment feature in VMware Cloud Partner Navigator to grant users Admin, Read Only or No Access roles to all IDP enabled VMware Cloud Director service Instances. The Admin role will login to instances with the CDS Provider Admin role. The Read Only role will login to instances with the CDS Provider Admin Read Only role.\nCreate Provider VDC #    Click on NEW\n  Enter details and then click on NEXT\n  Select vCenter and then click on NEXT\n  Select Resource Pool, Hardware version and then click on NEXT\n  Select the VMC Workload Storage Policy \u0026ndash; Cluster-1 and then click on NEXT.   Note: Make sure that the other storage policies are left unselected.\n Select NSX-T manager and Geneve Network pool and then click on Next.\n  Click on FINISH\n  Update External Network with valid IP range #    Click on Tier-0 Gateways in the left pane and then click the name of the pre-existing External Network.\n  Click on Network specification and then Edit.\n  Delete existing network spec by selecting it and then clicking on DELETE\n  Click on NEW\n  Enter Gateway CIDR and click on the pencil.\n  Note: We recommended that you use a subnet in the 100.64.0.0/10 range (RFC-6598 \u0026ndash; Carrier-grade NAT) to avoid conflicts with RFC-1918 private address space used in on premises locations and allow for extensive NATing of tenant IPs to the External Network. For example, you may choose 100.68.1.1/24 for the first SDDC deployed and use 100.68.2.1/24 for the second SDDC and so on. It is important to note that NSX-T uses 100.64.0.0/16 for T0-T1 interlink and is not available for use in an NSX-T environment like VMware Cloud on AWS.\n Enter Static IP Pools, click ADD and then click on SAVE\n  Click on **Save\n**  Create Inventory Group for External Networks #    Click Add Group\n  Enter Name and click on Set Members\n  Click on IP Addresses, enter the range associated with the external network previously specified and then click on APPLY\n  Click on SAVE\n  Create Firewall Rule to Allow VMware Cloud Director service Tenant Traffic #    Click Add Rule\n  Add rule details and then click on PUBLISH.\n  Notes: For Sources, make sure to select the Group created previously (VMware Cloud Director service External Network Ips). For Applied To, make sure to select Internet Interface.\nCreate First Tenant #  Create Organization #   Click on New  Fill in details and click on CREATE\n  Create Organization VDC #    Click on NEW\n  Fill in General details and click NEXT\n  Select Organization and click NEXT\n  Select Provider VDC and click NEXT\n  Select Allocation Model and click NEXT\n  Enter details and click NEXT\n  Select Storage Policy and click NEXT\n  Note: Thin provisioning and Fast provisioning are recommended, but not required.\n Select Network Pool and click NEXT\n  Confirm and click FINISH\n  Create Edge Gateway #    Click on NEW\n  Select Organization VDC and click on NEXT\n  Enter Name and click on NEXT\n  Select External Network and click on NEXT\n  Select Edge Cluster and click on NEXT\n  Add IP Allocation, click ADD, then click on NEXT\n  Review and click FINISH\n  Request a public IP for Tenant\u0026rsquo;s edge #    Click REQUEST NEW IP\n  Enter Notes and then click SAVE\n  Create a NAT pointing to the tenant\u0026rsquo;s edge gateway #    Click on ADD NAT RULE.\n  Select previously created public IP and make sure that the Internal IP matches the IP assigned to the edge gateway.\n  Click SAVE\n  Create Organization network #    Open Tenant portal by click on the box with the arrow next to the selected organization\n  Click on NEW\n  Select Scope and then click NEXT\n  Select Routed and then click NEXT\n  Select edge and the click NEXT\n  Enter name and CIDR and then click on NEXT\n  Enter Static IP Pool and then click on NEXT\n  Enter DNS and then click on NEXT  Review and click FINISH\n  Create SNAT to allow outbound traffic #    Select proper edge gateway and then under NAT click on NEW\n  Enter SNAT information and then click on SAVE.\n  Note: Make sure External IP is on the Edge and that the Internal IP matches the org network subnet\nConclusion #  At this point, the VMware Cloud Director service Instance is ready to deploy tenant VMs. For more information see the documentation for VMware Cloud on AWS, VMware Cloud Director service and VMware Cloud Director.\n"}]
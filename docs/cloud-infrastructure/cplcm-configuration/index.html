<!doctype html><html lang=en-us dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Product Repository #  During the first boot of a newly deployed VMware Cloud Provider Lifecycle Manager appliance, the system automatically creates the product directories and sets their permissions. You can either upload the product binaries to the respective directories or mount an existing pre-configured repository directory. On VMware Cloud Provider Lifecycle Manager, you must store the product deployment and upgrade files in the respective product directories.
Upload the Product OVA Files to the VMware Cloud Provider Lifecycle Manager Appliance #  You must upload the product OVA files and product update files to a specific pre-defined file structure.">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content>
<meta property="og:description" content="Product Repository #  During the first boot of a newly deployed VMware Cloud Provider Lifecycle Manager appliance, the system automatically creates the product directories and sets their permissions. You can either upload the product binaries to the respective directories or mount an existing pre-configured repository directory. On VMware Cloud Provider Lifecycle Manager, you must store the product deployment and upgrade files in the respective product directories.
Upload the Product OVA Files to the VMware Cloud Provider Lifecycle Manager Appliance #  You must upload the product OVA files and product update files to a specific pre-defined file structure.">
<meta property="og:type" content="article">
<meta property="og:url" content="http://vcpat.cloudhappens.io/docs/cloud-infrastructure/cplcm-configuration/"><meta property="article:section" content="docs">
<meta property="article:modified_time" content="2022-11-10T17:43:40-05:00">
<title>Cplcm Configuration | VMware Cloud Provider Architecture Toolkit</title>
<link rel=manifest href=/manifest.json>
<link rel=icon href=/favicon.png type=image/x-icon>
<link rel=stylesheet href=/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous>
<script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.dda70ff8fee48636c2a34590d782edf68585bab043dc9647332ce5195e679fd8.js integrity="sha256-3acP+P7khjbCo0WQ14Lt9oWFurBD3JZHMyzlGV5nn9g=" crossorigin=anonymous></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/><span>VMware Cloud Provider Architecture Toolkit</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li><a href=/feedback/><em>Feedback</em></a></li>
</ul>
<h2 id=draft-validated-solutions>
Draft Validated Solutions:
<a class=anchor href=#draft-validated-solutions>#</a>
</h2>
<ul>
<li><a href=/docs/cloud-infrastructure/><strong>Cloud Infrastructure</strong></a>
<ul>
<li><a href=/docs/cloud-infrastructure/planning/>Planning and Preparation</a></li>
<li><a href=/docs/cloud-infrastructure/design/>Design Objectives</a></li>
<li><a href=/docs/cloud-infrastructure/detailed-design/>Detailed Design</a></li>
<li><a href=/docs/cloud-infrastructure/implementation/>Implementation</a></li>
<li><a href=/docs/cloud-infrastructure/operations/>Operational Guidance</a></li>
<li><a href=/docs/cloud-infrastructure/design-decisions/>Design Decisions</a></li>
<li><a href=/docs/cloud-infrastructure/solution-interop/>Solution Interoperability</a></li>
</ul>
</li>
<li><a href=/docs/networking-security/><strong>Networking and Security</strong></a>
<ul>
<li><a href=/docs/networking-security/planning/>Planning and Preparation</a></li>
<li><a href=/docs/networking-security/design/>Design Objectives</a></li>
<li><a href=/docs/networking-security/detailed-design/>Detailed Design</a></li>
<li><a href=/docs/networking-security/implementation/>Implementation</a></li>
<li><a href=/docs/networking-security/operations/>Operational Guidance</a></li>
</ul>
</li>
<li><a href=/docs/dr-migration/><strong>DR and Migration</strong></a>
<ul>
<li><a href=/docs/dr-migration/planning/>Planning and Preparation</a></li>
<li><a href=/docs/dr-migration/design/>Design Objectives</a></li>
<li><a href=/docs/dr-migration/detailed-design/>Detailed Design</a></li>
<li><a href=/docs/dr-migration/implementation/>Implementation</a></li>
<li><a href=/docs/dr-migration/operations/>Operational Guidance</a></li>
</ul>
</li>
<li><a href=/docs/developer-ready-cloud/><strong>Developer Ready Cloud</strong></a>
<ul>
<li><a href=/docs/developer-ready-cloud/planning/>Planning and Preparation</a></li>
<li><a href=/docs/developer-ready-cloud/design/>Design Objectives</a></li>
<li><a href=/docs/developer-ready-cloud/detailed-design/>Detailed Design</a></li>
<li><a href=/docs/developer-ready-cloud/implementation/>Implementation</a></li>
<li><a href=/docs/developer-ready-cloud/operations/>Operational Guidance</a></li>
</ul>
</li>
<li><a href=/docs/sovereign-cloud/><strong>Sovereign Cloud</strong></a>
<ul>
<li><a href=/docs/sovereign-cloud/planning/>Planning and Preparation</a></li>
<li><a href=/docs/sovereign-cloud/design/>Design Objectives</a></li>
<li><a href=/docs/sovereign-cloud/detailed-design/>Detailed Design</a></li>
<li><a href=/docs/sovereign-cloud/implementation/>Implementation</a></li>
<li><a href=/docs/sovereign-cloud/operations/>Operational Guidance</a></li>
</ul>
</li>
</ul>
<h2 id=toolkit-documents>
Toolkit Documents:
<a class=anchor href=#toolkit-documents>#</a>
</h2>
<ul>
<li><strong>VMware Cloud Provider Lifecycle Manager</strong></li>
<li><a href=/docs/cloud-director/><strong>VMware Cloud Director</strong></a>
<ul>
<li>Scale</li>
<li>Multi-site</li>
<li><a href=/docs/cloud-director/identity-access/>Identity & Access</a></li>
<li>Extensibility</li>
<li>Branding & Themes</li>
<li>Automation</li>
</ul>
</li>
<li><strong>VMware Cloud Director service</strong>
<ul>
<li><a href=/docs/cloud-director-service/implementation/>Implementation</a></li>
</ul>
</li>
<li><strong>VMware Cloud Director Availability</strong></li>
<li><strong>VMware vCloud Usage Meter</strong></li>
<li><strong>VMware Cloud Director Container Service Extension</strong></li>
<li><strong>VMware Cloud Director Oject Storage Extension</strong></li>
<li><strong>VMware Cloud Director Application Launchpad</strong>
<br></li>
</ul>
<ul>
<li>
<a href=https://cloudsolutions.vmware.com target=_blank rel=noopener>
VMware Cloud Solutions
</a>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Cplcm Configuration</strong>
<label for=toc-control>
<img src=/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#product-repository>Product Repository</a>
<ul>
<li><a href=#upload-the-product-ova-files-to-the-vmware-cloud-provider-lifecycle-manager-appliance>Upload the Product OVA Files to the VMware Cloud Provider Lifecycle Manager Appliance</a></li>
<li><a href=#procedure>Procedure</a>
<ul>
<li><a href=#what-to-do-next>What to do next</a></li>
<li><a href=#mount-an-existing-shared-directory-to-vmware-cloud-provider-lifecycle-manager>Mount an Existing Shared Directory to VMware Cloud Provider Lifecycle Manager</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#vmware-cloud-provider-lifecycle-manager-certificate-management>VMware Cloud Provider Lifecycle Manager Certificate Management</a>
<ul>
<li><a href=#vmware-cloud-provider-lifecycle-manager-api-certificate-management>VMware Cloud Provider Lifecycle Manager API Certificate Management</a></li>
<li><a href=#vmware-cloud-provider-lifecycle-manager-ui-certificate-management>VMware Cloud Provider Lifecycle Manager UI Certificate Management</a></li>
<li><a href=#configure-custom-certificate-on-vmware-cloud-provider-lifecycle-manager>Configure custom certificate on VMware Cloud Provider Lifecycle Manager</a></li>
<li><a href=#configure-the-maximum-number-of-threads-vmware-cloud-provider-lifecycle-manager-can-run-in-parallel>Configure the Maximum Number of Threads VMware Cloud Provider Lifecycle Manager Can Run in Parallel</a></li>
</ul>
</li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h1 id=product-repository>
Product Repository
<a class=anchor href=#product-repository>#</a>
</h1>
<p>During the first boot of a newly deployed VMware Cloud Provider Lifecycle Manager appliance,
the system automatically creates the product directories and sets their permissions. You can either
upload the product binaries to the respective directories or mount an existing pre-configured
repository directory.
On VMware Cloud Provider Lifecycle Manager, you must store the product deployment and
upgrade files in the respective product directories.</p>
<h2 id=upload-the-product-ova-files-to-the-vmware-cloud-provider-lifecycle-manager-appliance>
Upload the Product OVA Files to the VMware Cloud Provider Lifecycle Manager Appliance
<a class=anchor href=#upload-the-product-ova-files-to-the-vmware-cloud-provider-lifecycle-manager-appliance>#</a>
</h2>
<p>You must upload the product OVA files and product update files to a specific pre-defined file
structure.
After the first boot, VMware Cloud Provider Lifecycle Manager creates a separate repository folder
for every product that the appliance can manage.
You can configure the permissions for every directory. As a result, the files within the directory
inherit the permissions you configure on the directory level.
At a later stage, if you add a new file to a product directory, the new file does not inherit the
permissions from the directory and you must configure the 755 permissions on a directory level
again.</p>
<h2 id=procedure>
Procedure
<a class=anchor href=#procedure>#</a>
</h2>
<p><strong>Create Repository directory structure for new deployment.</strong></p>
<p><em>mkdir -p /opt/vmware/cplcm/cplcmrepo/{rmq/rmq_version-number/ova,usage/um_version-number/ova,vcd/vcd_version-number/ova,vropsta/vrops_version-number/ova}</em></p>
<p><em><strong>Example</strong></em></p>
<p><em>[user@localhost]$ mkdir -p /opt/vmware/cplcm/cplcmrepo/{rmq/3.8.14/ova,usage/4.3.0/ova,vcd/10.2.2/ova,vropsta/2.5.0/ova}</em></p>
<p><strong>Create repository directory for product update files</strong></p>
<p><em>mkdir -p /opt/vmware/cplcm/cplcmrepo/{rmq/rmq_version-number/update,usage/um_version-number/update,vcd/vcd_version-number/update,vropsta/vrops_version-number/update}</em></p>
<p><em><strong>Example</strong></em></p>
<p><em>[user@localhost]$ mkdir -p /opt/vmware/cplcm/cplcmrepo/{rmq/3.8.14/update,usage/4.3.0/update,vcd/10.2.2/update,vropsta/2.5.0/update}</em></p>
<p>The directory structure is the following:<br>
&lt;product type>/&lt;version>/ova|update/&lt;file></p>
<p><strong>Note</strong>: The solution subdirectory specifies the version of the OVA or the patch.</p>
<p>Below is an example of the directory structure to be created:</p>
<p><img src=/images/Cloud-Infrastructure-CPLCM-Implementation/cplcm-2.jpg alt="Directory Structure"></p>
<h3 id=what-to-do-next>
What to do next
<a class=anchor href=#what-to-do-next>#</a>
</h3>
<p>Copy the product OVA files to the corresponding repository directory on the VMware Cloud Provider Lifecycle Manager appliance.</p>
<p><strong>Example:</strong></p>
<ul>
<li>
<p>To obtain the OVA for VMware Cloud Director, go to <a href=https://my.vmware.com/>https://my.vmware.com/</a></p>
</li>
<li>
<p>To obtain the OVA for vCloud Usage Meter, go to <a href=https://my.vmware.com/>https://my.vmware.com.</a></p>
</li>
<li>
<p>To obtain the OVA for vRealize Operations Manager Tenant App, go to <a href=https://marketplace.vmware.com/vsx/solutions/management-pack-for-vcloud-director#resources.>https:// marketplace.vmware.com/vsx/solutions/management-pack-for-vcloud-director#resources</a></p>
</li>
<li>
<p>To obtain the OVA for RabbitMQ, go to <a href=https://downloads.bitnami.com/files/stacks/rabbitmq/%203.8.14-0/bitnami-rabbitmq-3.8.14-0-linux-debian-10-x86_64-nami.ova.>https://downloads.bitnami.com/files/stacks/rabbitmq/ 3.8.14-0/bitnami-rabbitmq-3.8.14-0-linux-debian-10-x86_64-nami.ova.</a></p>
</li>
</ul>
<h3 id=mount-an-existing-shared-directory-to-vmware-cloud-provider-lifecycle-manager>
Mount an Existing Shared Directory to VMware Cloud Provider Lifecycle Manager
<a class=anchor href=#mount-an-existing-shared-directory-to-vmware-cloud-provider-lifecycle-manager>#</a>
</h3>
<p>You can mount an existing pre-configured repository directory to the VMware Cloud Provider Lifecycle Manager appliance.</p>
<p>If you do not specify the OVF property during the OVA deployment, after the deployment, you can configure the NFS by using the following commands.</p>
<p><strong>Procedure</strong></p>
<ul>
<li>Configure the automatic mounting of the NFS share with VMware Cloud Provider Lifecycle Manager.</li>
</ul>
<blockquote>
<p><em>echo &ldquo;nfs-server:nfs_dir_path/cplcmrepo nfs defaults 0 0&rdquo; >> /etc/fstab</em></p>
</blockquote>
<ul>
<li>Mount the NFS share to VMware Cloud Provider Lifecycle Manager.</li>
</ul>
<blockquote>
<p><em>mount /cplcmrepo</em></p>
</blockquote>
<h1 id=vmware-cloud-provider-lifecycle-manager-certificate-management>
VMware Cloud Provider Lifecycle Manager Certificate Management
<a class=anchor href=#vmware-cloud-provider-lifecycle-manager-certificate-management>#</a>
</h1>
<p>Configure VMware Cloud provider API and UI certificates.</p>
<h2 id=vmware-cloud-provider-lifecycle-manager-api-certificate-management>
VMware Cloud Provider Lifecycle Manager API Certificate Management
<a class=anchor href=#vmware-cloud-provider-lifecycle-manager-api-certificate-management>#</a>
</h2>
<p>After deploying the VMware Cloud Provider Lifecycle Manager appliance, VMware Cloud Provider Lifecycle Manager generates a self-signed certificates for the API and the internally used vault.</p>
<p>You can configure VMware Cloud Provider Lifecycle Manager to either use the self-signed certificate or your own custom certificate by providing a PKCS12 keystore containing the certificate.</p>
<p>VMware Cloud Provider Lifecycle Manager stores the properties for the alias, keystore name, type and password in the /opt/vmware/cplcm/config/application.properties file. To change these settings, you must update the application.properties file.</p>
<p>In /etc/environment, you can set the keystore password for the custom certificate by configuring the CPLCM_KEYSTORE_PW environment variable. Alternatively, you can configure it in the application.properties file for the server.ssl.key-store-password property.</p>
<h2 id=vmware-cloud-provider-lifecycle-manager-ui-certificate-management>
VMware Cloud Provider Lifecycle Manager UI Certificate Management
<a class=anchor href=#vmware-cloud-provider-lifecycle-manager-ui-certificate-management>#</a>
</h2>
<p>After deploying the VMware Cloud Provider Lifecycle Manager appliance, VMware Cloud Provider Lifecycle Manager generates a self-signed certificates for the UI.</p>
<p>You can configure VMware Cloud Provider Lifecycle Manager to either use the self-signed certificate or your own custom certificate by providing the custom certificate and key files in PEM format.</p>
<p>VMware Cloud Provider Lifecycle Manager stores the files with the certificate and key under the /opt/vmware/cplcm/security/certs/ directory. To change the certificate, you must replace the vcplcm-gui.pem and vcplcm-gui.key files, and restart the nginx service.</p>
<h2 id=configure-custom-certificate-on-vmware-cloud-provider-lifecycle-manager>
Configure custom certificate on VMware Cloud Provider Lifecycle Manager
<a class=anchor href=#configure-custom-certificate-on-vmware-cloud-provider-lifecycle-manager>#</a>
</h2>
<p>You can configure VMware Cloud Provider Lifecycle Manager to use a custom certificate.</p>
<p>To configure a custom certificate on VMware Cloud Provider Lifecycle Manager, you must provide a PKCS12 keystore containing the certificate.</p>
<p><strong>Procedure</strong></p>
<ol>
<li>Generate the custom certificate and create the keystore.</li>
</ol>
<p>CPLCM_CERT_DIR=/opt/vmware/cplcm/security/certs</p>
<blockquote>
<p>mkdir -p $CPLCM_CERT_DIR</p>
</blockquote>
<p>key_alias=vcplcm</p>
<p>keystore_password=$CPLCM_KEYSTORE_PW</p>
<p>subj="/CN=VCPLCM, O=VMware\, Inc, c=US"</p>
<blockquote>
<p>openssl req -x509 -newkey rsa:4096 -subj &ldquo;$subj&rdquo; -keyout $CPLCM_CERT_DIR/tmpKey.pem -out $CPLCM_CERT_DIR/tmpCert.pem -days 365 -nodes</p>
<p>openssl pkcs12 -export -out $CPLCM_CERT_DIR/vcplcm.p12 -name $key_alias -passout &ldquo;pass:$keystore_password&rdquo; -inkey $CPLCM_CERT_DIR/tmpKey.pem -in $CPLCM_CERT_DIR/tmpCert.pem</p>
</blockquote>
<ol start=2>
<li>After importing the keystore, remove the tmp key and certificate.</li>
</ol>
<blockquote>
<p>rm $CPLCM_CERT_DIR/tmpKey.pem</p>
<p>rm $CPLCM_CERT_DIR/tmpCert.pem</p>
</blockquote>
<h2 id=configure-the-maximum-number-of-threads-vmware-cloud-provider-lifecycle-manager-can-run-in-parallel>
Configure the Maximum Number of Threads VMware Cloud Provider Lifecycle Manager Can Run in Parallel
<a class=anchor href=#configure-the-maximum-number-of-threads-vmware-cloud-provider-lifecycle-manager-can-run-in-parallel>#</a>
</h2>
<p>You can configure the maximum thread number that VMware Cloud Provider Lifecycle Manager
can run in parallel.</p>
<p>The best practice recommendation is to configure VMware Cloud Provider Lifecycle Manager to run up to five parallel threads.
If you need to configure a value greater than five, first you must increase the CPU and memory of the VMware Cloud Provider Lifecycle Manager appliance.</p>
<p><strong>Procedure</strong></p>
<ol>
<li>SSH to the VMware Cloud Provider Lifecycle Manager appliance console and log in as vcplcm.</li>
<li>Navigate to the /opt/vmware/cplcm/config directory.
cd /opt/vmware/cplcm/config</li>
<li>Configure the maximum number of parallel threads.</li>
</ol>
<ul>
<li>Open the application.properties file for editing.</li>
</ul>
<blockquote>
<p>vi application.properties</p>
</blockquote>
<ul>
<li>Configure the maximum number of parallel threads by editing the value for the
execution.max.thread.count parameter.
By default, the value is set to 0. To configure a new value, you must use a numeric
character.</li>
<li>Save the application.properties file.</li>
</ul>
<blockquote>
<p>:wq!</p>
</blockquote>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#product-repository>Product Repository</a>
<ul>
<li><a href=#upload-the-product-ova-files-to-the-vmware-cloud-provider-lifecycle-manager-appliance>Upload the Product OVA Files to the VMware Cloud Provider Lifecycle Manager Appliance</a></li>
<li><a href=#procedure>Procedure</a>
<ul>
<li><a href=#what-to-do-next>What to do next</a></li>
<li><a href=#mount-an-existing-shared-directory-to-vmware-cloud-provider-lifecycle-manager>Mount an Existing Shared Directory to VMware Cloud Provider Lifecycle Manager</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#vmware-cloud-provider-lifecycle-manager-certificate-management>VMware Cloud Provider Lifecycle Manager Certificate Management</a>
<ul>
<li><a href=#vmware-cloud-provider-lifecycle-manager-api-certificate-management>VMware Cloud Provider Lifecycle Manager API Certificate Management</a></li>
<li><a href=#vmware-cloud-provider-lifecycle-manager-ui-certificate-management>VMware Cloud Provider Lifecycle Manager UI Certificate Management</a></li>
<li><a href=#configure-custom-certificate-on-vmware-cloud-provider-lifecycle-manager>Configure custom certificate on VMware Cloud Provider Lifecycle Manager</a></li>
<li><a href=#configure-the-maximum-number-of-threads-vmware-cloud-provider-lifecycle-manager-can-run-in-parallel>Configure the Maximum Number of Threads VMware Cloud Provider Lifecycle Manager Can Run in Parallel</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>
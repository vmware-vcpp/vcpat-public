<!doctype html><html lang=en-us dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="DR & Migration Planning and Preparation #  Before you start implementing the components of the {VVS for CP Title} solution, you must set up an environment that has a specific compute, storage, and network configuration, and that provides external services to the components of the solution.
Use the VMware Cloud Foundation Planning and Preparation Workbook to capture environment specific input values that are required during the implementation.
Carefully review the VMware Cloud Foundation Planning and Preparation Workbook before implementation to avoid costly rework and delays.">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content="DR & Migration Planning and Preparation">
<meta property="og:description" content="DR & Migration Planning and Preparation #  Before you start implementing the components of the {VVS for CP Title} solution, you must set up an environment that has a specific compute, storage, and network configuration, and that provides external services to the components of the solution.
Use the VMware Cloud Foundation Planning and Preparation Workbook to capture environment specific input values that are required during the implementation.
Carefully review the VMware Cloud Foundation Planning and Preparation Workbook before implementation to avoid costly rework and delays.">
<meta property="og:type" content="article">
<meta property="og:url" content="http://vcpat.cloudhappens.io/docs/dr-migration/planning/"><meta property="article:section" content="docs">
<meta property="article:modified_time" content="2022-07-05T17:29:22-04:00">
<title>DR & Migration Planning and Preparation | VMware Cloud Provider Architecture Toolkit</title>
<link rel=manifest href=/manifest.json>
<link rel=icon href=/favicon.png type=image/x-icon>
<link rel=stylesheet href=/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous>
<script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.5894a9444bd7cd14eb8aa5e822c2cab084ac8a0dc7bda0a66fb018127b326c5f.js integrity="sha256-WJSpREvXzRTriqXoIsLKsISsig3HvaCmb7AYEnsybF8=" crossorigin=anonymous></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/><span>VMware Cloud Provider Architecture Toolkit</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li><a href=/docs/cloud-infrastructure/><strong>Cloud Infrastructure</strong></a>
<ul>
<li><a href=/docs/cloud-infrastructure/planning/>Planning and Preparation</a></li>
<li><a href=/docs/cloud-infrastructure/design/>Design</a></li>
<li><a href=/docs/cloud-infrastructure/implementation/>Implementation</a></li>
<li><a href=/docs/cloud-infrastructure/operations/>Operations</a></li>
</ul>
</li>
<li><a href=/docs/networking-security/><strong>Networking & Security</strong></a>
<ul>
<li><a href=/docs/networking-security/planning/>Planning and Preparation</a></li>
<li><a href=/docs/networking-security/design/>Design</a></li>
<li><a href=/docs/networking-security/implementation/>Implementation</a></li>
<li><a href=/docs/networking-security/operations/>Operations</a></li>
</ul>
</li>
<li><a href=/docs/dr-migration/><strong>DR & Migration</strong></a>
<ul>
<li><a href=/docs/dr-migration/planning/ class=active>Planning and Preparation</a></li>
<li><a href=/docs/dr-migration/design/>Design</a></li>
<li><a href=/docs/dr-migration/implementation/>Implementation</a></li>
<li><a href=/docs/dr-migration/operations/>Operations</a></li>
</ul>
</li>
<li><a href=/docs/developer-ready-cloud/><strong>Developer Ready Cloud</strong></a>
<ul>
<li><a href=/docs/developer-ready-cloud/planning/>Planning and Preparation</a></li>
<li><a href=/docs/developer-ready-cloud/design/>Design</a></li>
<li><a href=/docs/developer-ready-cloud/implementation/>Implementation</a></li>
<li><a href=/docs/developer-ready-cloud/operations/>Operations</a></li>
</ul>
</li>
<li><a href=/docs/sovereign-cloud/><strong>Sovereign Cloud</strong></a>
<ul>
<li><a href=/docs/sovereign-cloud/planning/>Planning and Preparation</a></li>
<li><a href=/docs/sovereign-cloud/design/>Design</a></li>
<li><a href=/docs/sovereign-cloud/implementation/>Implementation</a></li>
<li><a href=/docs/sovereign-cloud/operations/>Operations</a>
<br></li>
</ul>
</li>
</ul>
<ul>
<li>
<a href=https://cloudsolutions.vmware.com target=_blank rel=noopener>
VMware Cloud Solutions
</a>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>DR & Migration Planning and Preparation</strong>
<label for=toc-control>
<img src=/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#dr--migration-planning-and-preparation>DR & Migration Planning and Preparation</a>
<ul>
<li><a href=#hardware-requirements>Hardware Requirements</a></li>
<li><a href=#other-requirements>Other Requirements</a></li>
<li><a href=#network-ports>Network Ports</a></li>
<li><a href=#important-considerations>Important Considerations</a>
<ul>
<li><a href=#replication-traffic>Replication Traffic</a></li>
<li><a href=#storage-requirements>Storage Requirements</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h1 id=dr--migration-planning-and-preparation>
DR & Migration Planning and Preparation
<a class=anchor href=#dr--migration-planning-and-preparation>#</a>
</h1>
<p>Before you start implementing the components of the {VVS for CP Title} solution, you must set up an environment that has a specific compute, storage, and network configuration, and that provides external services to the components of the solution.</p>
<p>Use the VMware Cloud Foundation Planning and Preparation Workbook to capture environment specific input values that are required during the implementation.</p>
<p>Carefully review the VMware Cloud Foundation Planning and Preparation Workbook before implementation to avoid costly rework and delays. Capture input values that are specific to your environment and verify that the components that are required by this solution are available.</p>
<p>The VMware Cloud Foundation Planning and Preparation Workbook contains inputs for each implementation and configuration procedure. Reference your values from the VMware Cloud Foundation Planning and Preparation Workbook to complete UI or PowerShell procedures.</p>
<p>#External Services
You use services that are external to VMware Cloud Foundation when implementing the solution-name solution.</p>
<table>
<thead>
<tr>
<th>External Service</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Active Directory (AD)</td>
<td>Active Directory (AD) is used to provide authentication and authorization to the VMware Cloud Foundation infrastructure.<br>This includes dedicated Domain Users with least privilege access to act as service accounts for component connectivity.</td>
</tr>
<tr>
<td>Domain Name Services (DNS)</td>
<td>Domain Name Services is used to ensure components are resolvable by FQDN and by IP address.</td>
</tr>
<tr>
<td>Network Time Protocol (NTP)</td>
<td>Network Time Protocol is used to synchronize time consistently across components.</td>
</tr>
<tr>
<td>Certificate Authority (CA)</td>
<td>Certificate Authority is used to provide signed certificates for user facing interfaces.</td>
</tr>
</tbody>
</table>
<p>Everything you need to know before deploying VMware Cloud Director Availability.</p>
<h2 id=hardware-requirements>
Hardware Requirements
<a class=anchor href=#hardware-requirements>#</a>
</h2>
<table>
<thead>
<tr>
<th>Appliance Type</th>
<th>Description and Services</th>
<th>Hardware Requirements</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cloud Replication Management Appliance</td>
<td>A dedicated appliance, that runs the following VMware Cloud Director Availability services: * Manager Service * Cloud Service with embedded VMware Cloud Director Availability Tenant Portal</td>
<td>- 2 vCPUs <br>- 4 GB RAM<br>- 10 GB Storage</td>
</tr>
<tr>
<td>Cloud Replicator Appliance</td>
<td>A dedicated appliance for the Replicator Service that handles the replication traffic for a site. For large-scale environments, you can deploy more than one Cloud Replicator Appliance per cloud site.</td>
<td>- 4 vCPUs <br>- 6 GB RAM <br>- 10 GB Storage</td>
</tr>
<tr>
<td>Cloud Tunnel Appliance</td>
<td>A dedicated appliance for the Tunnel Service.</td>
<td>- 2 vCPUs <br>- 2 GB RAM<br>- 10 GB Storage</td>
</tr>
</tbody>
</table>
<h2 id=other-requirements>
Other Requirements
<a class=anchor href=#other-requirements>#</a>
</h2>
<p>The resource vCenter Server instances within a VMware Cloud Director site must be within the same single sign-on domain. All Replicator Service, Manager Service, Cloud Service, and Tunnel Service instances within the respective site must be configured with that same single sign-on domain.</p>
<h2 id=network-ports>
Network Ports
<a class=anchor href=#network-ports>#</a>
</h2>
<table>
<thead>
<tr>
<th>Source</th>
<th>Destination</th>
<th>Port Number</th>
<th>Protocol</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>VMware Cloud Director Availability Replicator</td>
<td>ESXi Hosts</td>
<td>902</td>
<td>TCP and UDP</td>
<td>Used by the VMware Cloud Director Availability Replicator service for replication traffic to the destination ESXi hosts.</td>
</tr>
<tr>
<td>VMware Cloud Director Availability Replicator</td>
<td>VMware Platform Services Controller®</td>
<td>443</td>
<td>TCP</td>
<td>Used for single sign-on and Lookup Service communication.</td>
</tr>
<tr>
<td>VMware Cloud Director Availability Replicator</td>
<td>vCenter Server</td>
<td>443</td>
<td>TCP</td>
<td>Used by the local VMware Cloud Director Availability vApp Replication Manager service or the VMware Cloud Director Availability Replicator service for communication with the local vCenter Server.</td>
</tr>
<tr>
<td>VMware Cloud Director Availability Replicator</td>
<td>VMware Cloud Director Availability vApp Replication Manager</td>
<td>8044</td>
<td>TCP</td>
<td>Used for vCloud Availability vApp Replication Manager management from the vCloud Availability Replicator.</td>
</tr>
<tr>
<td>VMware Cloud Director Availability Replicator</td>
<td>VMware Cloud Director Availability Tunnel</td>
<td>8048</td>
<td>TCP</td>
<td>Used for VMware Cloud Director Availability vApp Replication Manager management from the VMware Cloud Director Availability Replicator.</td>
</tr>
<tr>
<td>VMware Cloud Director Availability vApp Replication Manager</td>
<td>VMware Platform Services Controller®</td>
<td>443</td>
<td>TCP</td>
<td>Used for single sign-on and Lookup Service communication.</td>
</tr>
<tr>
<td>VMware Cloud Director Availability vApp Replication Manager</td>
<td>VMware Cloud Director service</td>
<td>443</td>
<td>TCP</td>
<td>Used for VMware Cloud Director Director management from the VMware Cloud Director Availability vApp Replication Manager. </td>
</tr>
<tr>
<td>VMware Cloud Director Availability vApp Replication Manager</td>
<td>VMware Cloud Director Availability Replicator</td>
<td>8043</td>
<td>TCP</td>
<td>Used for VMware Cloud Director Availability Replicator management from the VMware Cloud Director Availability vApp Replication Manager. </td>
</tr>
<tr>
<td>VMware Cloud Director Availability vApp Replication Manager</td>
<td>VMware Cloud Director Availability Tunnel</td>
<td>8047, 8048</td>
<td>TCP</td>
<td>Used for VMware Cloud Director Availability Tunnel management from the VMware Cloud Director Availability vApp Replication Manager. </td>
</tr>
<tr>
<td>VMware Cloud Director Availability Tunnel</td>
<td>VMware Cloud Director Availability Replicator</td>
<td>8043, 44045</td>
<td>TCP</td>
<td>Used for VMware Cloud Director Availability Replicator management from the VMware Cloud Director Availability Tunnel. </td>
</tr>
<tr>
<td>VMware Cloud Director Availability Tunnel</td>
<td>VMware Cloud Director Availability vApp Replication Manager</td>
<td>8044, 8046</td>
<td>TCP</td>
<td>Used for VMware Cloud Director Availability vApp Replication Manager service management from the VMware Cloud Director Availability Tunnel appliance. </td>
</tr>
<tr>
<td>VMware Cloud Director Availability Tunnel</td>
<td>VMware Platform Services Controller®</td>
<td>443</td>
<td>TCP</td>
<td>Used for VMware Platform Services Controller® communication management from the VMware Cloud Director Availability vApp Replication Manager and VMware Cloud Director Availability Replicator. </td>
</tr>
<tr>
<td>ESXi Hosts</td>
<td>VMware Cloud Director Availability Replicator</td>
<td>31031, 44045, 44046</td>
<td>TCP</td>
<td>Used by the ESXi hosts for replication traffic to the destination VMware Cloud Director Availability Replicator service. </td>
</tr>
<tr>
<td>Firewall</td>
<td>VMware Cloud Director Availability Tunnel</td>
<td>8048</td>
<td>TCP</td>
<td>Used for redirecting external traffic management to the VMware Cloud Director Availability Tunnel service. </td>
</tr>
</tbody>
</table>
<h2 id=important-considerations>
Important Considerations
<a class=anchor href=#important-considerations>#</a>
</h2>
<h3 id=replication-traffic>
Replication Traffic
<a class=anchor href=#replication-traffic>#</a>
</h3>
<p>A typical good practice is to separate the management and resource vCenters/clusters. The number of hosts in resource vCenters/clusters is significantly higher than the number in the management cluster.
A recommendation is to deploy Replicators on resource hosts and not in the management cluster so more Replicators can be deployed and a DRS rule can be created to keep the Replicator VMs on different hosts for better load distribution.
Also, the replication traffic path from the Replicator appliances to the replication network on the resource hosts will be enhanced.
The hosts can use the management vmkernel interface to communicate with the Replicator. Another option is to have a dedicated vmkernel interface for replication purposes only.
Using the management vmkernel simplifies the configuration but significantly reduces the control options available to the administrator and can lead to a risk for routing uncompressed replication traffic, which is highly non-desired.
The general recommendation is to use a dedicated vmkernel for the replication traffic. In this case, the administrator will have better control over the infrastructure.
Using NIOC, the administrator will be able to set shares for different types of vmkernel traffic. It enables carrying the replication traffic over dedicated uplinks.</p>
<p><strong>Note</strong>: If any other VMware HBR-based replication products (vSphere Replication, VMware Site Recovery Manager or VMware HCX) are used in this cloud, configuring a dedicated vmkernel interface marked with “vSphere Replication” and “vSphere NFC Replication” will lead to all of these products try to use it. This means the network connectivity between their appliances and the replication vmkernel interfaces will be required to enable all of these products to operate successfully. For more information, please consult with respective product documentation.</p>
<h3 id=storage-requirements>
Storage Requirements
<a class=anchor href=#storage-requirements>#</a>
</h3>
<p>For a successful test failover, the destination storage must accommodate double the source virtual machine disk size. VMware Cloud Director Availability 4.2 and later do not consume double the disk size during failover.</p>
<ul>
<li>Example required space in the datastore, for a source virtual machine with a 2 TB virtual disk. When the replication is created, VMware Cloud Director Availability allocates 2 TB in the destination storage. VMware Cloud Director Availability allocates additional 2 TB when starting a test failover task. After finishing the test failover task, the additional 2 TB space is unallocated.</li>
<li>Example for a VMware vSAN storage, with the same virtual machine. The same storage implication applies, where the vSAN must accommodate double the virtual machine disk size. When the replication is created in this example, VMware Cloud Director Availability allocates 2 TB multiplied by the vSAN_Protection_Level_Disk_Space_Penalty. When starting a test failover task, additional 2 TB are allocated multiplied by the vSAN_Protection_Level_Disk_Space_Penalty.</li>
</ul>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#dr--migration-planning-and-preparation>DR & Migration Planning and Preparation</a>
<ul>
<li><a href=#hardware-requirements>Hardware Requirements</a></li>
<li><a href=#other-requirements>Other Requirements</a></li>
<li><a href=#network-ports>Network Ports</a></li>
<li><a href=#important-considerations>Important Considerations</a>
<ul>
<li><a href=#replication-traffic>Replication Traffic</a></li>
<li><a href=#storage-requirements>Storage Requirements</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>